(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function c(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((o=o.apply(e,t||[])).next())}))};var t=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function c(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((o=o.apply(e,t||[])).next())}))};function n(n){return t(this,void 0,void 0,(function*(){const t={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},o=yield function(t,n){return e(this,void 0,void 0,(function*(){const e=yield fetch(t,n);return yield e.json()}))}("https://api.dating.com/identity",t);return o}))}var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function c(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((o=o.apply(e,t||[])).next())}))};function r(e){const t=document.querySelector(".modal-window__notification");null==t||t.classList[e]("active")}function i(e){const t=e.value.trim();switch(e.name){case"email":return/\S+@\S+\.\S+/.test(t)?null:"Please enter a valid e-mail";case"password":return t.length>=8?null:"Password must be at least 8 characters";default:return null}}function a(e,t){(e instanceof HTMLInputElement?[e]:e).forEach((e=>{const n=e.closest(".modal-window__input-group");if(!n)return;const o=null==n?void 0:n.querySelector(".modal-window__error-message"),r=null==n?void 0:n.querySelectorAll(".modal-window__error-icon");o&&(t?(o.textContent=t,o.classList.add("error"),n.classList.add("error"),e.classList.add("error"),null==r||r.forEach((e=>e.classList.add("error")))):(o.textContent="",o.classList.remove("error"),e.classList.remove("error"),n.classList.remove("error"),null==r||r.forEach((e=>e.classList.remove("error")))))}))}function c(e,t){a(e,t)}function l(e){e.addEventListener("submit",(t=>o(this,void 0,void 0,(function*(){t.preventDefault();const o=i(e.email),a=i(e.password),l={email:e.email.value,password:e.password.value};if(o||a)return c(e.email,o),void c(e.password,a);try{const e=yield n(l);if(e.success)r("add");else{const t=null===e.desc?"Too Many Requests":e.desc;alert(t)}v("remove"),f("remove")}catch(e){console.error("Error submitting form data:",e),alert("Failed to connect. Please try again.")}}))))}const s={openRegistration:".button-modal-window",closeRegistration:".modal-window__close",overlay:".modal-overlay",modalRegistrationGroup:".modal-window__input-group",modalRegistration:".modal-window__registration",modalForm:"#modal-window__form"},u=document.querySelector(s.overlay),d=document.querySelector(s.modalRegistration),m=document.querySelectorAll(s.modalRegistrationGroup);function f(e){null==u||u.classList[e]("active")}function v(e){if("add"===e)null==d||d.classList.add("active");else{const e=document.querySelector(s.modalForm);null==d||d.classList.remove("active"),null==e||e.reset()}}function w(){v("add"),f("add"),function(){const e=document.querySelector("#modal-window__form");e&&l(e)}()}function y(){v("remove"),f("remove"),r("remove"),a(m,null)}document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(s.openRegistration),t=document.querySelectorAll(s.closeRegistration);null==e||e.addEventListener("click",w),t.forEach((e=>{e.addEventListener("click",y)})),null==u||u.addEventListener("click",(e=>{e.target===u&&y()})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&y()}))}))})();